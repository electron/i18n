# Многопоточность

С помощью [Web Workers][web-workers], есть возможность запускать JavaScript в потоках на уровне операционной системы.

## Многопоточный Node.js

Можно использовать узел. s Функции в веб-рабочих Electron, чтобы сделать таким образом, параметр `nodeIntegrationInWorker` должен быть установлен в `true` в `настройки`.

```javascript
let win = new BrowserWindow({
  webPreferences: {
    nodeIntegrationInWorker: true
  }
})
```

`nodeIntegrationInWorker` может использоваться независимо от `узлов интеграции`, но `песочница` не должна быть установлена как `true`.

## Доступные API

Все встроенные модули Node.js поддерживаются в Web Workers, и `asar` архивов все еще можно прочитать с помощью API Node.js. Однако ни один из встроенных модулей Electron не может быть использован в многопоточной среде.

## Нативные модули Node.js

Любой родной модуль Node.js может быть загружен непосредственно в Web Workers, но это настоятельно рекомендуется не делать это. Большинство из существующих родных модулей были написаны, исходя из однопоточной среды, используя их в Web Workers приведет к сбоям и повреждениям памяти.

Обратите внимание, что даже если родной узел. модуль s является безопасным для потоков, все еще не безопасно загрузить его в Web Worker'е, потому что процесс `. функция lopen` не является потоком безопасной.

Единственный способ безопасно загрузить родной модуль убедитесь, что приложение не загружает родные модули после запуска веб-работников.

```javascript
process.dlopen = () => {
  throw new Error('Загрузка родного модуля не безопасна')
}
let worker = new Worker('script.js')
```

[web-workers]: https://developer.mozilla.org/en/docs/Web/API/Web_Workers_API/Using_web_workers
