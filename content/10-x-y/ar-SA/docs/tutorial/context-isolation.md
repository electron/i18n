# عزل السياق

## ما هذا؟

العزلة السياقية هي ميزة تضمن تشغيل كلاً من البرامج النصية `مسبقاً` ومنطق Electron's الداخلي في سياق منفصل للموقع الذي تحمله في [`محتويات الويب`](../api/web-contents.md).  هذا مهم لأغراض الأمان لأنه يساعد على منع الموقع من الوصول إلى داخلي إلكترون أو APIs القوية التي يملك برنامج التحميل المسبق الخاص بك حق الوصول.

وهذا يعني أن كائن `النافذة` الذي يمكن الوصول إليه قبل تحميل البرنامج النصي الخاص بك هو في الواقع كائن **مختلف** عن الموقع الذي يمكن الوصول إليه.  على سبيل المثال، إذا قمت بتعيين `window.hello = 'wave'` في البرنامج النصي للتحميل المسبق الخاص بك ويتم تمكين عزل السياق `نافذة. مرحبًا` لن يتم تعريفه إذا حاول الموقع الوصول إليه.

يجب أن يكون لكل تطبيق منفرد منعزل سياقي، وسيتم تمكين إلكترون 12 بشكل افتراضي.

## كيف يمكنني تمكينها؟

من إلكترون 12، سيتم تمكين بشكل افتراضي. بالنسبة للإصدارات المنخفضة، هو خيار في `تفضيلات الويب` عند إنشاء `نافذة متصفح جديدة`'s.

```javascript
const mainWindow = متصفح جديد ({
  webPreferences: {
    contextIsolation: true
  }
})
```

## هجرة

> كنت أقوم بتوفير APIs من البرنامج النصي للتحميل المسبق باستخدام `window.X = apiObobjec` الآن ماذا؟

الكشف عن APIs من البرنامج النصي للتحميل المسبق لموقع الويب المحمل هو استخدام شائع، وهناك وحدة مخصصة في إلكترون لمساعدتك على القيام بذلك بطريقة مؤلمة.

**سابقاً: مع تعطيل عزلة السياق**

```javascript
window.myAPI = {
  doAthing: () => {}
}
```

**بعد ذلك: مع تمكين عزلة السياق**

```javascript
const { contextBridge } = require('electron')

contextBridge.exposeInMainWorld('myAPI , {
  doAthing: () => {}
})
```

يمكن استخدام وحدة [`سياق بريدج`](../api/context-bridge.md) **بأمان** الكشف عن واجهات برمجة التطبيقات من السياق المعزول الذي يعمل فيه البرنامج النصي للتحميل المسبق في السياق الذي يعمل فيه الموقع. سيتم الوصول إلى API أيضًا من الموقع على `window.myAPI` كما كان من قبل.

يجب عليك قراءة الوثائق `السياقية Bridge` المرتبطة أعلاه لفهم حدودها فهما كاملا.  على سبيل المثال لا يمكنك إرسال نماذج أو رموز مخصصة على الجسر.

## الاعتبارات الأمنية

فقط تمكين `سياق العزل` و استخدام `سياق العمود` لا يعني تلقائياً أن كل شيء تفعله آمن.  على سبيل المثال هذه التعليمة البرمجية **غير آمنة**.

```javascript
// ❌ كود سيئ
contextBridge.exposeInMainWorld('myAPI ، {
  send: ipcRenderer.send
})
```

إنه يكشف بشكل مباشر عن API قوي بدون أي نوع من التصفية وهذا من شأنه أن يسمح لأي موقع على الإنترنت بإرسال رسائل اعتباطية من IPC لا تريد أن تكون ممكنة. والطريقة الصحيحة للكشف عن مؤشرات API المعتمدة على IPC، بدلا من ذلك، هي توفير طريقة واحدة لكل رسالة من رسائل IPC.

```javascript
// ✅ رمز جيد
contextBridge.exposeInMainWorld('myAPI , {
  loadPreferences: () => ipcRenderer.invoke('load-prefs')
})
```

