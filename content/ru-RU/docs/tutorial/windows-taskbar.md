# Панель задач Windows

## Обзор

Electron имеет API для настройки значка приложения на панели задач Windows. Этот API поддерживает как Windows только функции, такие как [создание `JumpList`](#jumplist), [пользовательских эскизов и панелей инструментов](#thumbnail-toolbars), [значок накладывает](#icon-overlays-in-taskbar), и так называемый ["Flash Frame" эффект](#flash-frame), и кросс-платформенный функции как [последние документы][recent-documents] и [прогресс приложения][progress-bar].

## JumpList

Windows позволяет приложениям определять пользовательское контекстное меню, которое появляется, когда пользователи щелкают правой кнопкой мыши значок приложения на панели задач. Это контекстное меню называется `JumpList`. Вы указываете пользовательские действия в `Tasks` категории JumpList, цитируется из [MSDN][msdn-jumplist]:

> Приложения определяют задачи, основанные как на функциях программы, так и на ключевых моментах, которые пользователь должен делать с ними. Задачи должны быть контекстно-свободными, в данном случае, приложению не потребуется запускать их для работы. Они также должны быть статистически наиболее распространенными действиями, которые обычный пользователь будет выполнять в приложении, например, составить сообщение электронной почты или открыть календарь в почтовой программе, создать новый документ в текстовом редакторе, запустить приложение в определенном режиме, или запустить одну из своих подкоманд. Приложение не должно загромождать меню с расширенными функциями, которые не требуются обычным пользователям или одноразовыми действиями, такими как регистрация. Не используйте задачи для рекламных материалов, таких как обновления или специальные предложения.
> 
> Настоятельно рекомендуется, чтобы список задач был статическим. Он должен оставаться неизменным независимо от состояния или статуса приложения. Хотя можно динамически изменять список, вы должны учитывать, что это может смутить пользователя, который не ожидает изменения этой части списка адресатов.

![IE](https://i-msdn.sec.s-msft.com/dynimg/IC420539.png)

> ПРИМЕЧАНИЕ: Скриншот выше является примером общих задач  Internet Explorer

В отличие от меню dock в macOS, которое является реальным меню, пользовательские задачи в Windows работают как ярлыки приложений. Например, когда пользователь нажимает на задачу, программа будет выполняться с заданными аргументами.

Для настройки пользовательских задач для приложения можно использовать [app.setUserTasks][setusertaskstasks] API.

#### Примеры

##### Набор пользовательских задач

Начиная с рабочего приложения от [Руководство по быстрому](quick-start.md), обновите `main.js` файл с следующими строками:

```javascript
const { app } = require('electron')

app.setUserTasks([
  {
    program: process.execPath,
    arguments: '--new-window',
    iconPath: process.execPath,
    iconIndex: 0,
    title: 'New Window',
    description: 'Create a new window'
  }
])
```

##### Четкий список задач

Чтобы очистить список задач, необходимо вызвать `app.setUserTasks` с пустым массива в `main.js` файле.

```javascript
const { app } = require('electron')

app.setUserTasks([])
```

> ПРИМЕЧАНИЕ: Задачи пользователя по-прежнему будут отображаться даже после закрытия приложения , поэтому значок и путь программы, указанные для задачи, должны существовать до тех пор, пока ваше приложение не будет заблокировано.

### Thumbnail Toolbars

На Windows можно добавить панель инструментов эскиза с указанными кнопками в панель задач макет окна приложения. Он предоставляет пользователям возможность доступа к команды конкретного окна без восстановления или активации окна.

Как цитирует [MSDN][msdn-thumbnail]:

> Эта панель инструментов является обычным управлением стандартной панелью инструментов. У него максимум из семи кнопок. Идентификатор каждой кнопки, изображение, подсказка и состояние определены в структуре, которая затем передается на панель задач. Приложение может показать, включить, отключить или скрыть кнопки из панели инструментов эскизов, как это требуется текущего состояния.
> 
> Например, Windows Media Player может предлагать стандартные средства управления мультимедиа транспортом , такие как воспроизведение, пауза, приглушение и остановка.

![игрок](https://i-msdn.sec.s-msft.com/dynimg/IC420540.png)

> ПРИМЕЧАНИЕ: Скриншот выше, является примером эскиза панели инструментов Windows Media Player

Чтобы установить панель инструментов эскизов в приложении, необходимо использовать [BrowserWindow.setThumbarButtons][setthumbarbuttons]

#### Примеры

##### Установить панель инструментов эскиза

Начиная с рабочего приложения от [Руководство по быстрому](quick-start.md), обновите `main.js` файл с следующими строками:

```javascript
const { BrowserWindow } - требуют ('электрон')
const путь - требуют ('путь')

const выиграть - новый BrowserWindow ()

win.setThumbarButtons (является
  и
    tooltip: 'button1',
    значок: path.join (__dirname, 'button1.png'),
    click () консоль.log ('button1 нажал'
    
  )
    значок: path.join (__dirname, 'button2.png'), флаги
    : "включено", "dismissonclick",
    click () - консоль.log ('button2 нажал.') (

)
```

##### Чистая панель инструментов эскиза

Чтобы очистить кнопки панели инструментов эскиза, вам нужно `BrowserWindow.setThumbarButtons` с пустым массивом в `main.js` файле.

```javascript
const { BrowserWindow } = require('electron')

const win = new BrowserWindow()
win.setThumbarButtons([])
```

### Наслоения значков в панели задач

На Windows кнопка панели задач может использовать небольшую накладку для отображения статуса.

Как цитирует [MSDN][msdn-icon-overlay]:

> Наслоения иконок служат контекстуальным уведомлением о статусе, и предназначены для отказа от необходимости отдельной иконки статуса области уведомлений, чтобы сообщить пользователю эту информацию. Например, новый статус почты в Microsoft Outlook, в настоящее время отображается в области уведомлений, можно указывать через накладываемое изображение на кнопку панели задач. Опять же, вы должны решить в течение цикла разработки , какой метод лучше подходит для вашего приложения. Накладываемые иконки предназначены для предоставления важных, давно существующих статусов или уведомлений, таких как сетевой статус, статус сообщения или новая почта. Пользователь не должен быть с постоянно меняющимися наслоениями или анимацией.

![Наложение на кнопку панели задач](https://i-msdn.sec.s-msft.com/dynimg/IC420441.png)

> ПРИМЕЧАНИЕ: Скриншот выше является примером наложения на кнопку панели задач

Чтобы установить значок наложения для окна, необходимо использовать [BrowserWindow.setOverlayIcon][setoverlayicon] API.

#### Пример

Начиная с рабочего приложения от [Руководство по быстрому](quick-start.md), обновите `main.js` файл с следующими строками:

```javascript
const { BrowserWindow } - требуют ('электрон')

const win - новый BrowserWindow ()

win.setOverlayIcon ('path/to/overlay.png', 'Описание для наложения')
```

### Флэш-кадр

На Windows можно выделить кнопку панели задач, чтобы привлечь внимание пользователя. Это похоже на подпрыгивая значок дока в macOS.

Как цитирует [MSDN][msdn-flash-frame]:

> Как правило, окно мигает, чтобы сообщить пользователю, что окно требует , но что в настоящее время он не имеет фокус клавиатуры.

Чтобы мигать кнопкой панели задач BrowserWindow, необходимо использовать [BrowserWindow.flashFrame][flashframe] API.

#### Пример

Начиная с рабочего приложения от [Руководство по быстрому](quick-start.md), обновите `main.js` файл с следующими строками:

```javascript
const { BrowserWindow } - требуют ('электрон')

const win - новый BrowserWindow ()

win.once ('фокус', () -> win.flashFrame (ложный))
win.flashFrame (правда)
```

> ПРИМЕЧАНИЕ: Не забудьте позвонить `win.flashFrame(false)` , чтобы выключить вспышку. В приведенном выше примере он называется, когда окно находится в фокусе, но для его отключения можно использовать тайм-аут или какое-либо другое событие.

[msdn-jumplist]: https://docs.microsoft.com/en-us/windows/win32/shell/taskbar-extensions#tasks

[msdn-thumbnail]: https://docs.microsoft.com/en-us/windows/win32/shell/taskbar-extensions#thumbnail-toolbars

[msdn-icon-overlay]: https://docs.microsoft.com/en-us/windows/win32/shell/taskbar-extensions#icon-overlays

[msdn-flash-frame]: https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-flashwindow#remarks

[setthumbarbuttons]: ../api/browser-window.md#winsetthumbarbuttonsbuttons-windows
[setusertaskstasks]: ../api/app.md#appsetusertaskstasks-windows
[setoverlayicon]: ../api/browser-window.md#winsetoverlayiconoverlay-description-windows
[flashframe]: ../api/browser-window.md#winflashframeflag
[recent-documents]: ./recent-documents.md
[progress-bar]: ./progress-bar.md
