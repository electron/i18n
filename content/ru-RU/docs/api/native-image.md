# nativeImage

> Создает иконки приложения, в том числе для системного лотка (Windows), дока (macOS), используя файлы PNG и JPG.

Процессы: [Основной](../glossary.md#main-process), [Графический](../glossary.md#renderer-process)

В Electron для API, которые принимают изображения, можно пройти либо пути файлов, либо `NativeImage` экземпляры. При `null` будет использоваться пустое изображение.

Например, при создании вкладки в области уведомлений или установке иконки окна можно задать путь к файлу изображения в виде `String`:

```javascript
const { BrowserWindow, Tray } - требуют ('электрон')

const appIcon - новый Tray ('/Пользователи/кто-то/изображения/икона.png')
const win - новый BrowserWindow (я значок: '/Пользователи/кто-то/изображения/окно.png') консоль
.log (appIcon, win)
```

Или прочитайте изображение с буфера обмена, который возвращает `NativeImage`:

```javascript
const { clipboard, Tray } = require('electron')
const image = clipboard.readImage()
const appIcon = new Tray(image)
console.log(appIcon)
```

## Поддерживаемые форматы

В `PNG` поддерживаются `JPEG` форматы изображений и изображения. `PNG` рекомендуется использовать -за его поддержки прозрачности и без потерь сжатия.

На Windows также можно загрузить `ICO` с файловых путей. Для лучшего качества рекомендуется включать по крайней мере следующие размеры в:

* Мелкие значки
  * 16x16 (100% DPI scale)
  * 20x20 (125% DPI scale)
  * 24x24 (150% DPI scale)
  * 32x32 (200% DPI scale)
* Большие значки
  * 32x32 (100% DPI scale)
  * 40x40 (125% DPI scale)
  * 48x48 (150% DPI scale)
  * 64x64 (200% DPI scale)
  * 256x256

Проверьте раздел *Size requirements* в [этой статье][icons].

## Изображения с высоким разрешением

На платформах, имеющих поддержку высокого DPI, таких как дисплеи Apple Retina, вы можете добавить `@2x` после имени файла изображения, чтобы пометить его как изображение с высоким разрешением.

Например, если `icon.png` является нормальным изображением со стандартным разрешением, то `icon@2x.png` будет рассматриваться как изображение с высоким разрешением, которое имеет двойную плотность данных.

Если вы хотите поддерживать дисплеи с разной плотностью DPI одновременно, вы можете поместить изображения с разными размерами в ту же папку и использовать суффиксы файлоими. Например:

```plaintext
images/
├── icon.png
├── icon@2x.png
└── icon@3x.png
```

```javascript
const { Tray } требуют ('электрон')
const appIcon - новый Tray ('/Пользователи/кто-то/изображения/икона.png')
консоль.log (appIcon)
```

Поддерживаются также следующие суффиксы для ДОИ:

* `@1x`
* `@1.25x`
* `@1.33x`
* `@1.4x`
* `@1.5x`
* `@1.8x`
* `@2x`
* `@2.5x`
* `@3x`
* `@4x`
* `@5x`

## Шаблон изображения

Шаблонные изображения состоят из черного и альфа-канала. Шаблонные изображения не предназначены для использования в качестве автономных изображений и, как правило смешиваются с другим контентом для создания желаемого окончательного внешнего вида.

Наиболее распространенным случаем является использование изображений шаблонов для значка бара меню, поэтому он может как к светлым, так и к темным барам меню.

**Внимание:** Шаблонные изображения поддерживаются только на macOS.

Чтобы отметить изображение в качестве шаблона изображения, его имя файла должно закончиться словом `Template`. Например:

* `xxxTemplate.png`
* `xxxTemplate@2x.png`

## Методы

Модуль `nativeImage` имеет следующие методы, все из которых возвращают экземпляр класса `NativeImage`:

### `nativeImage.createEmpty()`

Возвращает `NativeImage`

Создает пустой экземпляр `NativeImage`.

### `nativeImage.createThumbnailFromPath(path, maxSize)` _macOS_ _Windows_

* `path` String - путь к файлу, из которого мы намерены построить миниатюру.
* `maxSize` [размер](structures/size.md) - максимальная ширина и высота (положительные цифры) эскиз возвращается может быть. Реализация Windows будет игнорировать `maxSize.height` и масштабировать высоту в соответствии с `maxSize.width`.

Возвращает `Promise<NativeImage>` - выполнено с изображением предварительного просмотра эскиза файла, который является [NativeImage](native-image.md).

### `nativeImage.createFromPath(path)`

* `path` String

Возвращает `NativeImage`

Создает новый экземпляр `NativeImage` из файла, расположенного по адресу `path`. Этот метод возвращает пустое изображение, если путь `path` не существует, не может быть прочитан или является некорректным.

```javascript
const nativeImage - требуют ('electron').nativeImage

const image - nativeImage.createFromPath ('/Users/somebody/images/icon.png')
консоли.log (изображение)
```

### `nativeImage.createFromBitmap(buffer, options)`

* `buffer` [Buffer][buffer]
* `options` Object
  * `width` Integer
  * `height` Integer
  * `scaleFactor` Double (опционально) - По умолчанию 1.0.

Возвращает `NativeImage`

Создает новую модель `NativeImage` из `buffer` , которая содержит необработанные бит-карты пиксельные данные, возвращенные `toBitmap()`. Конкретный формат зависит от платформы.

### `nativeImage.createFromBuffer(buffer[, options])`

* `buffer` [Buffer][buffer]
* `options` Object (опционально)
  * `width` Integer (необязательно) - Требуется для буферов bitmap.
  * `height` Integer (опционально) - требуется для буферов растровых изображений.
  * `scaleFactor` Double (опционально) - По умолчанию 1.0.

Возвращает `NativeImage`

Создает новый `NativeImage` из `buffer`. Пытается расшифровать как PNG или JPEG в первую очередь.

### `nativeImage.createFromDataURL(dataURL)`

* `dataURL` String

Возвращает `NativeImage`

Создает новый `NativeImage` из `dataURL`.

### `nativeImage.createFromNamedImage(imageName[, hslShift])` _macOS_

* `imageName` String
* `hslShift` Number[] (опционально)

Возвращает `NativeImage`

Создает новый экземпляр `NativeImage` из NSImage, который сопоставляется с заданным именем изображения. Смотрите [`System Icons`](https://developer.apple.com/design/human-interface-guidelines/macos/icons-and-images/system-icons/) для получения списка возможных значений.

`hslShift` применяется к изображению со следующими правилами:

* `hsl_shift[0]` (оттенок): Абсолютное значение оттенка для изображения - 0 и 1 карта 0 и 360 на колесе цвета оттенка (красный).
* `hsl_shift[1]` (насыщенность): сдвиг насыщенности для изображения, с ключевыми значениями: 0 и удалить весь цвет. 0,5 = оставить без изменений. 1 - полностью насытить изображение.
* `hsl_shift[2]` (легкость): Сдвиг легкости для изображения, с ключевыми значениями: 0 - удалить всю легкость (сделать все пиксели черными). 0,5 = оставить без изменений. 1 = полная яркость (сделать все точки белыми).

Это означает, что `[-1, 0, 1]` сделает изображение полностью белым, а `[-1, 1, 0]` сделает изображение полностью чёрным.

В некоторых случаях `NSImageName` не соответствует строковому представлению; одним из примеров может служить `NSFolderImageName`, строковое представление которого будет `NSFolder`. Поэтому вам нужно определить правильное представление строк для вашего изображения, перед тем как его передавать. Это можно сделать следующим образом:

`echo -e '#import <Cocoa/Cocoa.h>\nint main() { NSLog(@"%@", SYSTEM_IMAGE_NAME); }' | clang -otest -x objective-c -framework Cocoa - && ./test`

где `SYSTEM_IMAGE_NAME` следует заменить любым значением из [этого списка](https://developer.apple.com/documentation/appkit/nsimagename?language=objc).

## Класс: NativeImage

> Встроенная упаковка изображений, таких как область уведомлений, док-станция и значки приложений.

Процессы: [Основной](../glossary.md#main-process), [Графический](../glossary.md#renderer-process)

### Методы экземпляра

Для экземпляров класса `NativeImage` доступны следующие методы:

#### `image.toPNG([options])`

* `options` Object (опционально)
  * `scaleFactor` Double (опционально) - По умолчанию 1.0.

Возвращает `Buffer` - A [Buffer][buffer], который содержит закодированные данные изображения `PNG`.

#### `image.toJPEG(quality)`

* `quality` Integer - Качество От 0 до 100.

Возвращает `Buffer` - A [Buffer][buffer], который содержит закодированные данные изображения `JPEG`.

#### `image.toBitmap([options])`

* `options` Object (опционально)
  * `scaleFactor` Double (опционально) - По умолчанию 1.0.

Возвращает `Buffer` - [Buffer][buffer], который содержит копию сырых данных растровых пикселей изображения.

#### `image.toDataURL([options])`

* `options` Object (опционально)
  * `scaleFactor` Double (опционально) - По умолчанию 1.0.

Возвращает `String` - данные URL изображения.

#### `image.getBitmap([options])`

* `options` Object (опционально)
  * `scaleFactor` Double (опционально) - По умолчанию 1.0.

Возвращает `Buffer` - [Buffer][buffer], который содержит сырые данные растровых пикселей изображения.

Разница между `getBitmap()` и `toBitmap()` заключается в том, что `getBitmap()` не данные биткарты, поэтому вам придется использовать возвращенный буфер немедленно в текущего цикла событий; в противном случае данные могут быть изменены или уничтожены.

#### `image.getNativeHandle()` _macOS_

Возвращает `Buffer` - [Buffer][buffer] в котором хранится указатель C на базовый собственный дескриптор изображения. На macOS возвращается указатель на экземпляр `NSImage`.

Обратите внимание, что возвращаемый указатель - это слабый указатель на исходное изображение, а не на копию, поэтому вы _должны_ убедиться, что связанный с ним экземпляр `NativeImage` находится рядом.

#### `image.isEmpty()`

Возвращает `Boolean` - признак того что изображение пустое.

#### `image.getSize ([scaleFactor])`

* `scaleFactor` Double (опционально) - По умолчанию 1.0.

Возвращает [`Size`](structures/size.md).

Если `scaleFactor` будет пройден, это вернет размер, соответствующий представлению изображения, наиболее близко соотвествуя пройденное значение.

#### `image.setTemplateImage(option)`

* `option` Boolean

Помечает изображение как шаблон изображения.

#### `image.isTemplateImage()`

Возвращает `Boolean` - признак того что изображение является шаблоном.

#### `image.crop(rect)`

* `rect` [Rectangle](structures/rectangle.md) - область изображения до которой нужно обрезать.

Возвращает `NativeImage` - обрезанное изображение.

#### `image.resize(options)`

* `options` Object
  * `width` Integer (по желанию) - по умолчанию по ширине изображения.
  * `height` Integer (опционально) - По умолчанию высота изображения.
  * `quality` String (опционально) - Желаемое качество изображения при изменения размера. Возможные значения являются `good`, `better`, или `best`. The default is `best`. These values express a desired quality/speed tradeoff. Они переведены в алгоритм-специфический метод, который зависит от (CPU, GPU) базовой платформы. Все три метода могут быть с тем же алгоритмом на данной платформе.

Возвращает `NativeImage` - измененый размер изображения.

Если указаны только `height` или `width`, то текущее соотношение сторон будет сохранено в изображении.

#### `image.getAspectRatio ([scaleFactor])`

* `scaleFactor` Double (опционально) - По умолчанию 1.0.

Возвращает `Float` - пропорции изображения.

Если `scaleFactor` будет пройден, это вернет соотношение аспектов, соответствующее представлению изображения, наиболее близко соотвествуя пройденное значение.

#### `image.getScaleFactors()`

Возвращает `Float[]` - массив всех факторов масштаба, соответствующих представлениям для данного nativeImage.

#### `image.addRepresentation(options)`

* `options` Object
  * `scaleFactor` Double - коэффициент масштаба, чтобы добавить представление изображения для.
  * `width` Integer (optional) - Defaults to 0. Требуется, если буферная бит-карты указана как `buffer`.
  * `height` Integer (optional) - Defaults to 0. Требуется, если буферная бит-карты указана как `buffer`.
  * `buffer` Buffer (optional) - The buffer containing the raw image data.
  * `dataURL` String (необязательно) - URL-адрес данных, содержащий либо базовый 64 закодированное изображение PNG или JPEG.

Добавьте представление изображения для определенного фактора масштаба. Это может быть использовано для явного добавления различных представлений фактора масштаба к изображению. Этот можно назвать на пустых изображениях.

### Свойства экземпляра

#### `nativeImage.isMacTemplateImage` _macOS_

Свойство `Boolean` определяет, считается ли [изображение шаблоном](https://developer.apple.com/documentation/appkit/nsimage/1520017-template).

Пожалуйста, обратите внимание, что это свойство влияет только на macOS.

[icons]: https://msdn.microsoft.com/en-us/library/windows/desktop/dn742485(v=vs.85).aspx

[buffer]: https://nodejs.org/api/buffer.html#buffer_class_buffer
