---
title: 'Проект тижня: WebTorrent'
author:
  - ферос
  - zeke
date: '2017-03-14'
---

Цього тижня ми наздогнали [@feross](https://github.com/feross) і [@dcposch](https://github.com/dcposch) говорити про WebTorrent, веб-підтримуваний торрент-клієнт, який разом з'єднує користувачів для формування розподіленої, децентралізованої мережі браузера.

---

## Що таке WebTorrent?

[WebTorrent](https://webtorrent.io) - це перший торрент-клієнт, який працює в браузері. Він написаний у JavaScript і використовує WebRTC для однорангового транспорту. Не потрібен плагін браузера, розширення чи встановлення.

Використовуючи відкриті веб-стандарти, WebTorrent з'єднує користувачів веб-сайтів разом для формування розповсюдженої, децентралізованої мережі для ефективної передачі файлів.

Демо можна побачити в дії WebTorrent тут: [webtorrent.io](https://webtorrent.io/).

<a href="https://webtorrent.io/">
  <img alt="домашня сторінка веб-торрента" src="https://cloud.githubusercontent.com/assets/2289/23912149/1543d2ce-089c-11e7-8519-613740c82b47.jpg">
</a>

## Чому це круто?

Уявіть відео-сайт, який схожий на YouTube, але де відвідувачі допомагають розмістити зміст сайту. Чим більше людей, що користуються сайтом, що працює на базі WebTorrent, тим швидше і стійкіше.

Спілкування Браузера та браузера виводить середнього значення і дозволяє людям спілкуватися на власних умовах. Більше немає жодного клієнта/сервера - просто мережа учасників, все рівно. WebTorrent - це перший крок у подорожі, який повторно децентралізує Веб.

## Де Electron увійде у фото?

Приблизно рік тому ми вирішили створити [WebTorrent Робочий стіл](https://webtorrent.io/desktop/)- версію WebTorrent яка працює як настільний додаток.

[![Вікно програвання стільниці WebTorrent](https://cloud.githubusercontent.com/assets/2289/23912152/154aef0a-089c-11e7-8544-869b0cd642b1.jpg)](https://webtorrent.io/desktop/)

Ми створили WebTorrent версію з трьох причин:

1. Ми хотіли мати чистий, легкий та безрекламний додаток з відкритим вихідним кодом
2. Ми хотіли торрент застосунок з хорошою підтримкою трансляцій
3. Нам потрібно гібридний клієнт, який з'єднує BitTorrent і WebTorrent мережі

## Якщо ми вже можемо завантажити торенти у моєму браузері то чому додаток для комп'ютера?

По-перше, дещо фон в дизайні WebTorrent.

<a href="https://webtorrent.io/desktop/">
  <img alt="логотип стільниці webtorrent" src="https://cloud.githubusercontent.com/assets/2289/23912151/154657e2-089c-11e7-9889-6914ce71ebc9.png" width="200" align="right">
</a>

В перші дні BitTorrent використовував TCP як свій транспортний протокол. Пізніше, uTP прийшов з перспективним поліпшенням продуктивності та додаткових переваг через TCP. З часом кожен основний торрент-клієнт повністю прийнятий uTP, і сьогодні ви можете використовувати BitTorrent над будь-яким протоколом. WebRTC протокол - це наступний логічний крок. Це призводить до обіцянки сумісності з веб-браузерами – до однієї гігантської мережі P2P клієнтів BitTorrent та мільйонів веб-браузерів.

“Веб-учасники” (торент-учасники, що працюють у веб-браузері), роблять мережу BitTorrent сильнішою, додавши мільйони нових учасників, і поширення BitTorrent до десятків нових сенсів використання. WebTorrent стежить за швидкістю BitTorrent якомога ближче, щоб полегшити роботу існуючих клієнтів BitTorrent для отримання підтримки у WebTorrent.

Деякі торрент застосунки, такі як [Vuze](https://www.vuze.com/) , вже підтримують веб-сайтів, але ми не хотіли чекати навколо інших, щоб додати підтримку. **Так як і на веб-Торрент стільниці WebTorrent - це наш спосіб пришвидшити прийняття протоколу WebTorrent .** Створюючи чудовий торрент додаток, який люди дійсно хочуть використовувати, ми збільшуємо кількість учасників мережі, які можуть ділитися торрентами із веб-однолітками (і. . користувачі на сайтах).

## Які деякі цікаві випадки можна використовувати для торентів, крім того, що вони вже можуть зробити?

Одне з найбільш захоплюючих застосувань для WebTorrent — доставка за участі однолітків. Неприбуткові проекти, такі як [Wikipedia](https://www.wikipedia.org/) та [Internet Archive](https://archive.org/) можуть зменшити пропускну спроможність та розміщення витрат, дозволяючи відвідувачам чіпам чіпу. Популярний вміст можна вести у браузері для браузера, швидко та дешево. Рідко доступний вміст можна надавати за HTTP з сервера джерела.

Інтернет-архів вже оновив свої торрент-файли, тому вони добре працюють з WebTorrent. Так що, якщо ви хочете вставити вміст Інтернет-архіву на ваш сайт, ви можете зробити це таким чином, що зменшує витрати на хостинг для архіву, дозволяє їм приділяти більше грошей для архівації Інтернету!

Існують також захоплюючі справи для використання у CDNS та інспекторії по P2P.

## Які ваші улюблені проекти використовують WebTorrent?

![скриншот програм gaia](https://cloud.githubusercontent.com/assets/2289/23912148/154392c8-089c-11e7-88a8-3d4bcb1d2a94.jpg)

Найкрутіша річ, побудована з WebTorrent, руки теж [Gaia 3D Star Map](http://charliehoey.com/threejs-demos/gaia_dr1.html). Це 3D інтерактивна симуляція Чумацького Шляху. Дані завантажуються з торенту, прямо в браузері. Це не просто надихнуло нас летіти крізь зіркову систему і зрозуміти, наскільки маленькими ми люди порівнюються із неосяжністю нашого всесвіту.

Ви можете прочитати про те, як це було зроблено в [Торенті Галактики](https://medium.com/@flimshaw/torrenting-the-galaxy-extracting-2-million-3d-stars-from-180gb-of-csvs-457ff70c0f93), допис в блозі автора, Чарлі Хей, пояснює, як він побудував зіркову карту WebGL і WebTorrent.

<a href="https://brave.com/">
  <img alt="Хоробрий логотип" src="https://cloud.githubusercontent.com/assets/2289/23912147/1542ad4a-089c-11e7-8106-15c8e34298a9.png" width="150" align="left">
</a>

Також ми величезні шанувальники [Хоробрий](https://brave.com/). Хоробрий є браузер, що автоматично блокує рекламу і трекери, щоб зробити веб швидше і безпечніше. Відважно додати торрент підтримку, щоб ви могли [переглянути традиційні торенти, не використовуючи окрему програму](https://torrentfreak.com/brave-a-privacy-focused-browser-with-built-in-torrent-streaming-170219/). Ця функція працює на WebTorrent.

Отже, так само, як більшість браузерів можуть показувати файли PDF. Хоробрий список може відображати магнітні посилання і торрент файли. Це просто інший тип вмісту, який підтримує браузер.

Одним з співзасновників Brave є Брендан Ейх, творцем JavaScript, мова, яку ми написали в WebTorrent - ми вважаємо, що дуже круто, що Хоробрий вирішується для інтеграції WebTorrent.

## Чому ви вирішили створити WebTorrent Робочий стіл на Electron?

<a href="https://webtorrent.io/desktop/">
  <img alt="Головне вікно робочого столу WebTorrent" src="https://cloud.githubusercontent.com/assets/2289/23912150/15444542-089c-11e7-91ab-7fe3f1e5ee43.jpg" align="right" width="450">
</a>

Існує мем, що програми Electron "пропускаються", оскільки вони включають в себе весь модуль контенту Chrome в кожному додатку. У деяких випадках це частково вірно (програма Electron, як правило, ~ 40 МБ, де програма для конкретної ОС зазвичай має ~20 МБ).

Проте, у випадку WebTorrent Desktop, ми використовуємо майже кожну особливість Electron і багато десятків Chrome функцій у процесі нормальної роботи. Якщо ми хотіли реалізувати ці можливості з нуля для кожної платформи, Минуло б місяці чи роки довше, щоб створити наш додаток, або ж ми мали б вивільнити лише одну платформу.

Просто, щоб отримати ідею, ми використовуємо [інтеграцію до панелі завдань](https://electronjs.org/docs/api/app/#appdockbouncetype-macos) (щоб показати прогрес завантаження), [інтеграція з панеллю меню](https://electronjs.org/docs/api/menu) (щоб запустити у фоновому режимі), [Реєстрація протоколу](https://electronjs.org/docs/api/app/#appsetasdefaultprotocolclientprotocol-path-args-macos-windows) (відкрити магнітні посилання) [зарядний блокувальник](https://electronjs.org/docs/api/power-save-blocker/) (щоб запобігти сну під час відтворення відео), та [автоматичного оновлення](https://electronjs.org/docs/api/auto-updater). Що стосується функції Chrome, то ми використовуємо позначку `<video>` (відтворювати багато різних відеоформатів) тег `<track>` (для закритих субтитрів), підтримка перетягування і WebRTC (яка не є тривіальною для використання в рідному додатку).

Не згадувати: наш торрент двигун написаний на JavaScript і має на увазі існування багатьох API Node, але особливо `require('net')` and `require('dgram')` для підтримки TCP та UDP сокету.

В основному, Electron це те, що ми потребуємо, і мав точний набір функцій, які ми потребуємо для відправлення суцільної, полірованої програми в рекордному часі.

## Які ваші улюблені речі про Electron?

Бібліотека WebTorrent існує в розробці як проект з відкритим вихідним кодом на два роки. **Ми зробили ПК в WebTorrent протягом чотирьох тижнів.** Electron це основна причина, що ми змогли створити та відправити нашу програму так швидко.

Як Ні. s зробив серверне програмування доступним для покоління програмістів з використанням jQuery-, Electron робить розробку застосунків доступним для будь-кого, хто знайомий з Web чи Node. s розробка. Electron надзвичайно розширення можливостей.

## Чи сайт та клієнт стільниці спільно користуються кодом?

Так, [`webtorrent` пакет npm](https://npmjs.com/package/webtorrent) працює в браузері і і в Electron. Точно такий самий код може працювати у всіх середовищах - це краса JavaScript. Зараз це універсальний ранг. Java-яблука обіцяла додаткам "Писати, запускайте будь-де", але це бачення ніколи не матеріалізовано з кількох причин. Електрон, більш, ніж будь-яка інша платформа, стає досить тісно близько до того ідеалу.

## Які певні виклики ви зіткнулися при створенні WebTorrent?

У ранніх версіях додатку ми з усіх сил намагаємося зробити UI продуктивним. Розставляємо торрент-двигун в той же процес рендерингу, що малює головне вікно додатку, яке передбачувано. призводить до повільності при інтенсивній активності ЦП з торрент-двигуна (наприклад, перевірки шматочків торенту, отриманих від учасників).

Ми виправили цей рух, перемістивши торент в другий, невидимий процес рендерингу, з яким ми спілкуємося понад [IPC](https://electronjs.org/docs/api/ipc-main/). Таким чином, якщо цей процес коротко використовує багато процесора, користувацька тема не вплине. Плавне прокручування та анімації дуже задовільняють.

Примітка: нам довелося помістити торент-двигун у процес рендерингу, замість процесу "main", оскільки нам потрібен доступ до WebRTC (який доступний лише в рендерингу.)

## В яких областях потрібно покращити Electron ?

Одна річ, яку ми хотіли б побачити - це краща документація про те, як створити та підготовлені до виробництва кораблів, особливо навколо хитрих тем, таких як підписання коду та автоматичне оновлення. Ми повинні були дізнатися про найкращі практики, розбившись у вихідному коді та запитуючи у Твіттері!

## Чи виконує робоча стільниця WebTorrent? Якщо ні, то що далі?

Ми думаємо, що поточна версія WebTorrent Робочого столу є відмінною, але в ній завжди є можливість для вдосконалення. Наразі ми працюємо над покращенням поліції, продуктивності та підтримки субтитрів і підтримкою відео-кодеків.

Якщо вам цікаво взяти участь у проекті, подивіться [нашу сторінку GitHub](https://github.com/feross/webtorrent-desktop)!

## Будь-які поради щодо розробки Electron, які можуть бути корисними для інших розробників?

[Фероси](http://feross.org/), один з розробників WebTorrent нещодавно виступила розмова *"Реальний світ Electron: Створення крос-платформенних застосунків з JavaScript"* в NodeConf Argentina у якій містяться корисні поради для випуску полірованого додатку Electron. Виступ - це особливо корисний, якщо ви на етапі, коли у вас є базовий робочий додаток, і ви намагаєтеся прокласти його до наступного рівня поліції та професіоналізму.

[Дивитися тут](https://www.youtube.com/watch?v=YLExGgEnbFY): <iframe width="100%" height="360" src="https://www.youtube.com/embed/YLExGgEnbFY?rel=0" frameborder="0" allowfullscreen mark="crwd-mark"></iframe>

[Слайди тут](https://speakerdeck.com/feross/real-world-electron):

<script async class="speakerdeck-embed" data-id="5aae08bb7c5b4dbd89060cff11bb1300" data-ratio="1.77777777777778" src="//speakerdeck.com/assets/embed.js"></script>

[DC](https://dcpos.ch/), інший розробник WebTorrent написав(), [контрольний список речей, які ви можете зробити](https://blog.dcpos.ch/how-to-make-your-electron-app-sexy) щоб ваш додаток відчувався каліком і дячним. Вона складається з прикладів коду і охоплює такі речі, як інтеграція з macOS dock, перетягування і закінчення настільних сповіщень, а також пришвидшує завантаження програми.

