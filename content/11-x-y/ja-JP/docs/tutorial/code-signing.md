# ã‚³ãƒ¼ãƒ‰ç½²å

ã‚³ãƒ¼ãƒ‰ç½²åã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æŠ€è¡“ã®ã²ã¨ã¤ã§ã€ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ãŸã®ãŒã‚ãªãŸã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºå®Ÿã«ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚

macOS ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ãã®å¤‰æ›´ãŒèª¤ã‚Šã‹æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦å°å…¥ã•ã‚ŒãŸã®ã‹ã«ã‹ã‹ã‚ã‚‰ãšã€ã‚¢ãƒ—ãƒªã«å¯¾ã™ã‚‹å¤‰æ›´ã‚’æ¤œå‡ºã§ãã¾ã™ã€‚

Windows ã§ã¯ã€ã‚³ãƒ¼ãƒ‰ç½²åè¨¼æ˜æ›¸ã«ä¿¡é ¼ãƒ¬ãƒ™ãƒ«ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ãã†ã§ãªã„å ´åˆã‚„ã€ä¿¡é ¼ãƒ¬ãƒ™ãƒ«ãŒä½ã„ã¨ã€ãƒ¦ãƒ¼ã‚¶ãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã‚ˆã†ã¨ã—ãŸã¨ãã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚  ä¿¡é ¼ãƒ¬ãƒ™ãƒ«ã¯æ™‚é–“ã¨ã¨ã‚‚ã«ä¸Šæ˜‡ã™ã‚‹ã®ã§ã€ã§ãã‚‹ã ã‘æ—©ãã‚³ãƒ¼ãƒ‰ç½²åã—å§‹ã‚ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

æœªç½²åã®ã‚¢ãƒ—ãƒªã‚’é…å¸ƒã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã™ãŒã€éæ¨å¥¨ã§ã™ã€‚ Windows ã¨ macOS ã®ä¸¡æ–¹ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœªç½²åã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚„å®Ÿè¡Œã‚’é˜»å®³ã—ã¾ã™ã€‚ macOS Catalina (ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 10.15) ä»¥é™ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç½²åã•ã‚Œã¦ã„ãªã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ãã«ã¯ã€è¤‡æ•°ã‚ã‚‹æ‰‹å‹•ã®æ‰‹é †ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

![macOS Catalina Gatekeeper ã®è­¦å‘Š: ã“ã®ã‚¢ãƒ—ãƒªã¯ã€é–‹ç™ºå…ƒãŒæœªç¢ºèªã®ãŸã‚é–‹ã‘ã¾ã›ã‚“](../images/gatekeeper.png)

è¦‹ã‹ã‘ä¸Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ 2 ã¤ã®é¸æŠè‚¢ãŒã‚ã‚Šã¾ã™ã€‚ã‚¢ãƒ—ãƒªã‚’ã‚´ãƒŸç®±ã«ç›´æ¥ç§»å‹•ã™ã‚‹ã‹ã€å®Ÿè¡Œã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ã‹ã§ã™ã€‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã•ã›ãŸãã¯ãªã„ã§ã—ã‚‡ã†ã€‚

ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ã¦é…å¸ƒã™ã‚‹äºˆå®šã® Electron ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¦ã„ã‚‹å ´åˆã¯ã€ã‚³ãƒ¼ãƒ‰ç½²åã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

# macOS ãƒ“ãƒ«ãƒ‰ã¸ã®ç½²å & å…¬è¨¼

macOS ã‚¢ãƒ—ãƒªã‚’ãƒªãƒªãƒ¼ã‚¹ã«å‘ã‘ã¦é©åˆ‡ã«æº–å‚™ã™ã‚‹ã«ã¯ã€2 ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ãŒå¿…è¦ã§ã™ã€‚ã¾ãšã€ã‚¢ãƒ—ãƒªã‚’ã‚³ãƒ¼ãƒ‰ç½²åã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ãã—ã¦ã€"å…¬è¨¼" ã¨å‘¼ã°ã‚Œã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã®ãŸã‚ã«ã‚¢ãƒ—ãƒªã‚’ Apple ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚è‡ªå‹•åŒ–ã•ã‚ŒãŸã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã£ã¦ã€ã‚¢ãƒ—ãƒªãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å±é™ºã«ã•ã‚‰ã™ã‚ˆã†ãªã“ã¨ã‚’ã—ã¦ã„ãªã„ã‹ã©ã†ã‹ã€ã•ã‚‰ã«ç¢ºèªã—ã¾ã™ã€‚

ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã«ç¤ºã™ã‚¢ãƒ—ãƒªã¸ã®ç½²åã¨å…¬è¨¼ã®è¦ä»¶ã‚’æº€ãŸã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

1. [Apple Developer Program][] ã«ç™»éŒ²ã™ã‚‹ (å¹´ä¼šè²»ãŒå¿…è¦)
2. [Xcode][] ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ - ã“ã‚Œã¯ macOS ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«å¿…è¦ã§ã™
3. [ç½²åè¨¼æ˜æ›¸][] ã‚’ç”Ÿæˆã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹

Electron ã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã§ã¯æ§‹æˆã¨ãã®è‡ªç”±åº¦ã‚’é‡è¦–ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç½²åã¨å…¬è¨¼ã®å–å¾—ã«ã¯è¤‡æ•°ã®æ–¹æ³•ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

## `electron-forge`

å¥½ããª Electron ã®ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç½²åã¨å…¬è¨¼ã‚’è¡Œã†ã«ã‚ãŸã£ã¦ã€è¨­å®šã«ã„ãã¤ã‹è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ [Forge](https://electronforge.io) is a collection of the official Electron tools, using [`electron-packager`][], [`electron-osx-sign`][], and [`electron-notarize`][] under the hood.

ã“ã“ã§ã¯ã€ã™ã¹ã¦ã®å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¨­å®šã—ãŸä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ ã™ã¹ã¦ãŒå¿…é ˆã¨ã„ã†ã‚ã‘ã§ã¯ç„¡ã„ã®ã§ã™ã€‚ãŠä½¿ã„ã®ãƒ„ãƒ¼ãƒ«ã¯é©åˆ‡ãª `identity` ã‚’è‡ªå‹•çš„ã«è¦‹ã¤ã‘ã‚‰ã‚Œã‚‹ã§ã—ã‚‡ã†ã€‚ãã‚Œã§ã‚‚æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

```json
{
  "name": "my-app",
  "version": "0.0.1",
  "config": {
    "forge": {
      "packagerConfig": {
        "osxSign": {
          "identity": "Developer ID Application: Felix Rieseberg (LT94ZKYDCJ)",
          "hardened-runtime": true,
          "entitlements": "entitlements.plist",
          "entitlements-inherit": "entitlements.plist",
          "signature-flags": "library"
        },
        "osxNotarize": {
          "appleId": "felix@felix.fun",
          "appleIdPassword": "my-apple-id-password",
        }
      }
    }
  }
}
```

Apple ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’ä¿è¨¼ã™ã‚‹ãŸã‚ã€ã“ã“ã§å‚ç…§ã•ã‚Œã¦ã„ã‚‹ `plist` ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãª macOS å›ºæœ‰ã®è³‡æ ¼æƒ…å ±ãŒå…¥ã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
  <dict>
    <key>com.apple.security.cs.allow-jit</key>
    <true/>
    <key>com.apple.security.cs.allow-unsigned-executable-memory</key>
    <true/>
    <key>com.apple.security.cs.debugger</key>
    <true/>
  </dict>
</plist>
```

ã“ã®å®Ÿä¾‹ã‚’ã™ã¹ã¦è¦‹ãŸã„ã®ã§ã‚ã‚Œã°ã€Electron Fiddle ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã€[ç‰¹ã« `electron-forge` ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«](https://github.com/electron/fiddle/blob/master/forge.config.js) ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

If you plan to access the microphone or camera within your app using Electron's APIs, you'll also need to add the following entitlements:

```xml
<key>com.apple.security.device.audio-input</key>
<true/>
<key>com.apple.security.device.camera</key>
<true/>
```

If these are not present in your app's entitlements when you invoke, for example:

```js
const { systemPreferences } = require('electron')

const microphone = systemPreferences.askForMediaAccess('microphone')
```

Your app may crash. See the Resource Access section in [Hardened Runtime](https://developer.apple.com/documentation/security/hardened_runtime) for more information and entitlements you may need.

## `electron-builder`

Electron Builder ã«ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ç½²åã™ã‚‹ãŸã‚ã®ã‚«ã‚¹ã‚¿ãƒ ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒä»˜å±ã—ã¦ã„ã¾ã™ã€‚ [ãã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã“ã¡ã‚‰](https://www.electron.build/code-signing) ã«ã‚ã‚Šã¾ã™ã€‚

## `electron-packager`

If you're not using an integrated build pipeline like Forge or Builder, you are likely using [`electron-packager`][], which includes [`electron-osx-sign`][] and [`electron-notarize`][].

Packager ã® API ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€[ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ç½²åã¨å…¬è¨¼ã®ä¸¡æ–¹ã‚’è¡Œã†è¨­å®š](https://electron.github.io/electron-packager/master/interfaces/electronpackager.options.html) ã‚’æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

```js
const packager = require('electron-packager')

packager({
  dir: '/path/to/my/app',
  osxSign: {
    identity: 'Developer ID Application: Felix Rieseberg (LT94ZKYDCJ)',
    'hardened-runtime': true,
    entitlements: 'entitlements.plist',
    'entitlements-inherit': 'entitlements.plist',
    'signature-flags': 'library'
  },
  osxNotarize: {
    appleId: 'felix@felix.fun',
    appleIdPassword: 'my-apple-id-password'
  }
})
```

Apple ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’ä¿è¨¼ã™ã‚‹ãŸã‚ã€ã“ã“ã§å‚ç…§ã•ã‚Œã¦ã„ã‚‹ `plist` ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãª macOS å›ºæœ‰ã®è³‡æ ¼æƒ…å ±ãŒå…¥ã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
  <dict>
    <key>com.apple.security.cs.allow-jit</key>
    <true/>
    <key>com.apple.security.cs.allow-unsigned-executable-memory</key>
    <true/>
    <key>com.apple.security.cs.debugger</key>
    <true/>
  </dict>
</plist>
```

## Mac App Store

[Mac App Store Guide][] ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

# Windows ãƒ“ãƒ«ãƒ‰ã®ç½²å

Windows ãƒ“ãƒ«ãƒ‰ã«ç½²åã™ã‚‹å‰ã«ã€ä»¥ä¸‹ã®ã“ã¨ã‚’ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

1. Windows Authenticode ã‚³ãƒ¼ãƒ‰ç½²åè¨¼æ˜æ›¸ã‚’å–å¾—ã—ã¾ã™ (å¹´ä¼šè²»ãŒå¿…è¦ã§ã™)
2. Visual Studio ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ç½²åãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’å–å¾—ã—ã¾ã™ (ç„¡æ–™ã® [Community Edition](https://visualstudio.microsoft.com/vs/community/) ã§ååˆ†ã§ã™)

å¤šãã®å†è²©æ¥­è€…ã‹ã‚‰ã‚³ãƒ¼ãƒ‰ç½²åè¨¼æ˜æ›¸ã‚’å…¥æ‰‹ã§ãã¾ã™ã€‚ ä¾¡æ ¼ã¯ã•ã¾ã–ã¾ã§ã™ã®ã§ã€é¸ã¶ã®ã«è¿·ã†ã§ã—ã‚‡ã†ã€‚ äººæ°—ã®ã‚ã‚‹å†è²©æ¥­è€…ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

* [digicert](https://www.digicert.com/code-signing/microsoft-authenticode.htm)
* [Comodo](https://www.comodo.com/landing/ssl-certificate/authenticode-signature/)
* [GoDaddy](https://au.godaddy.com/web-security/code-signing-certificate)
* ã¨ã‚Šã‚ã‘ã€ã‚ãªãŸã®ãƒ‹ãƒ¼ã‚ºã«åˆã£ãŸã‚‚ã®ã‚’è¦‹ã¤ã‘ã‚‹ã®ã§ã‚ã‚Œã°æ¢ã—ã¦ã¿ã¦ãã ã•ã„ã€‚Google ã¯å‹é”ã§ã™ ğŸ˜„

ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ç½²åã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚

- [`electron-winstaller`][] will generate an installer for windows and sign it for you
- [`electron-forge`][] can sign installers it generates through the Squirrel.Windows or MSI targets.
- [`electron-builder`][] ã§ã¯ãã® Windows ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ã„ãã¤ã‹ã«ç½²åã™ã‚‹ã“ã¨ãŒã§ãã¾ã™

## Windows Store

[Windows Store Guide][] ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[Apple Developer Program]: https://developer.apple.com/programs/
[`electron-builder`]: https://github.com/electron-userland/electron-builder
[`electron-forge`]: https://github.com/electron-userland/electron-forge
[`electron-osx-sign`]: https://github.com/electron-userland/electron-osx-sign
[`electron-packager`]: https://github.com/electron/electron-packager
[`electron-notarize`]: https://github.com/electron/electron-notarize
[`electron-winstaller`]: https://github.com/electron/windows-installer
[Xcode]: https://developer.apple.com/xcode
[ç½²åè¨¼æ˜æ›¸]: https://github.com/electron/electron-osx-sign/wiki/1.-Getting-Started#certificates
[Mac App Store Guide]: mac-app-store-submission-guide.md
[Windows Store Guide]: windows-store-guide.md
