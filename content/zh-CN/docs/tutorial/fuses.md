# 电子保险丝

> 包装时间功能切换

## 什么是保险丝？

对于电子功能的子集，为整个应用程序禁用某些功能是有意义的。  例如，99% 的应用不使用 `ELECTRON_RUN_AS_NODE`，这些应用希望能够发布无法使用该功能的二进制文件。  我们也不希望电子消费者从源头上构建电子，因为这既是一个巨大的技术挑战，又具有高昂的时间和金钱成本。

保险丝是解决这个问题的解决方案，在高水平上，它们是电子二进制文件中的"神奇位"，在包装您的电子应用程序以启用/禁用某些功能/限制时可以翻转。  因为它们在代码签署应用之前在包装时间翻转，因此操作系统将负责确保这些位不会通过操作系统级别代码签名验证（看门人/应用锁）翻转回来。

## 如何翻转引信？

### 简单的方法

我们制作了一个方便的模块 `@electron/fuses` ，使翻转这些引信变得简单。  有关使用情况和潜在错误案例的更多详细信息，请查看该模块的 README。

```js
需要（'@electron/引信）。翻转（
  //电子
  路径需要（"电子"），
  //引信翻转
  {
    runAsNode: false
  }
）
```

### 艰难的道路

#### 快速词汇表

* **引信线**：电子二进制中用于控制引信的字节序列
* **哨兵**： 一个静态的已知字节序列， 你可以用它来定位保险丝
* **保险丝架**：引信线的格式/允许值

手动翻转引信需要编辑电子二进制，并将引信线修改为代表您想要的引信状态的字节序列。

在电子二进制的某处将有一系列字节看起来像这样：

```text
|...二进制|sentinel_bytes |fuse_version |fuse_wire_length |fuse_wire |...二进制|
```

* `sentinel_bytes` 总是这个确切的字符串 `dL7pKGdnNz796PbbjQWNKmHXBZaB9tsX`
* `fuse_version` 是一个单一的手提包，其未签名的整数值表示引信模式的版本
* `fuse_wire_length` 是一个单一的手提包，其未签名的整数值表示以下引信线中的引信数量
* `fuse_wire` 是一个N字节序列，每个字节代表一个导火索及其状态。
  * "0"（0x30）表示保险丝已禁用
  * "1"（0x31）表示导火索已启用
  * "r"（0x72）表示保险丝已被移除，将手提包更改为 1 或 0 将不起作用。

要翻转引信，您可以在保险丝中找到其位置，并根据您希望的状态将其更改为"0"或"1"。

您可以在此处查看当前的模式 [](https://github.com/electron/electron/blob/master/build/fuses/fuses.json)。
